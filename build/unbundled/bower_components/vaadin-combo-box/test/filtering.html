<!DOCTYPE html><html><head><meta charset="UTF-8"><title>vaadin-combo basic tests</title><script src="../../web-component-tester/browser.js"></script><link rel="import" href="common.html"></head><body><test-fixture id="combobox"><template><vaadin-combo-box></vaadin-combo-box></template></test-fixture><script>describe("filtering items",function(){function e(){return l.$.overlay._items}function o(){return l.$.input}function t(e){o().bindValue=e,o().fire("input")}function n(e){return o().bindValue}var l;beforeEach(function(){l=fixture("combobox"),l.items=["foo","bar","baz"]}),describe("setting the input field value",function(){it("should open the popup if closed",function(){l.close(),t("foo"),expect(l.opened).to.equal(!0)}),it("should open the popup when input field is cleared",function(){l.value="foo",l.close(),expect(l.opened).to.equal(!1),t(""),expect(l.opened).to.equal(!0)}),it("should not change the value of the combobox",function(){l.value="foo",t("bar"),expect(l.value).to.equal("foo")}),it("should set the combobox value when closing",function(){l.value="foo",t("bar"),l.close(),expect(l.value).to.equal("bar")}),it("should set the combobox value when closing case insensitively",function(){l.value="foo",t("BAR"),l.close(),expect(l.value).to.equal("bar")}),it("should be reverted to the combobox value when cancelled",function(){l.value="foo",t("b"),l.cancel(),expect(n()).to.equal("foo")}),it("should be revert to the combobox value when selecting the same value",function(){l.value="foo",t("FOO"),l.close(),expect(n()).to.equal("foo")})}),describe("focusing items while filtering",function(){it("should focus on an exact match",function(){t("bar"),expect(l._focusedIndex).to.eql(0)}),it("should not scroll to selected value when filtering",function(){l.value="baz";var e=sinon.spy(l.$.overlay,"_scrollIntoView");t("ba"),t("b"),expect(e.callCount).to.eql(1)})}),describe("filtering items",function(){it("should filter items using contains",function(){t("a"),expect(e()).to.eql(["bar","baz"])}),it("should filter out all items with a invalid filter",function(){t("qux"),expect(e()).to.be.empty}),it("should be reset after closing the dropdown",function(){t("foo"),l.close(),expect(l._filter).to.be.empty}),it("should filter boolean",function(){l.items=[!0,!1],t("t"),expect(e()).to.eql([!0])}),it("should show initial selection",function(){l.value="foo",l.open(),expect(l.$.overlay.$.selector.selectedItems).to.contain("foo")}),it("should not lose the selected value",function(){l.value="foo",t("bar"),expect(l.$.overlay.$.selector.selectedItems).to.be["null"],t(""),expect(l.$.overlay.$.selector.selectedItems).to.contain("foo")}),it("should ignore case",function(){t("FOO"),expect(e()).to.eql(["foo"])}),it("should focus filtered items on match case insensitively",function(){t("BA"),expect(l._focusedIndex).to.equal(-1),t("BAR"),expect(l._focusedIndex).to.equal(0)}),it("should reset focus when filter changes",function(){t("BAR"),t("BA"),expect(l._focusedIndex).to.equal(-1)}),it("should not filter with a null filter",function(){t(null),expect(e()).to.eql(["foo","bar","baz"])}),it("should not throw an error when items arent set",function(){l.items=null,t("foo"),expect(e()).to.be["null"]}),it("should hide overlay when filtered items length is 0",function(){t("THIS IS NOT FOUND"),expect(l.opened&&l.$.overlay.hidden).to.be["true"]})})});</script></body></html>