<html><head><link rel="import" href="../polymer/polymer.html"><link rel="import" href="../iron-ajax/iron-ajax.html"><link rel="import" href="tpa-ajax-builder.html"></head><body><dom-module id="tpa-ajax"><template><iron-ajax id="ironAjax" url="{{url}}" auto="{{auto}}" params="{{params}}" method="{{method}}" headers="{{headers}}" content-type="{{contentType}}" sync="{{sync}}" body="{{body}}" handle-as="{{handleAs}}" with-credentials="{{withCredentials}}" verbose="{{verbose}}" loading="{{loading}}" active-requests="{{activeRequests}}" timeout="{{timeout}}" jsonprefix="{{jsonPrefix}}" debounceduration="{{debounceDuration}}" on-response="_handleResponse" on-error="_handleError" on-request="_handleRequest"></iron-ajax></template><script>"use strict";Polymer({is:"tpa-ajax",hostAttributes:{hidden:!0},properties:{url:{type:String},params:{type:Object,value:function(){return{}}},method:{type:String,value:"GET"},headers:{type:Object,value:function(){return{}}},contentType:{type:String,value:null},body:{type:Object,value:null},sync:{type:Boolean,value:!1},handleAs:{type:String,value:"json"},withCredentials:{type:Boolean,value:!1},timeout:{type:Number,value:0},auto:{type:Boolean,value:!1},verbose:{type:Boolean,value:!1},lastRequest:{type:Object,notify:!0,readOnly:!0},loading:{type:Boolean,notify:!0,readOnly:!0},lastResponse:{type:Object,notify:!0,readOnly:!0},lastError:{type:Object,notify:!0,readOnly:!0},activeRequests:{type:Array,notify:!0,readOnly:!0,value:function(){return[]}},debounceDuration:{type:Number,value:0,notify:!0},jsonPrefix:{type:String,value:""},bubbles:{type:Boolean,value:!1},ajaxBuilder:{type:Object}},get queryString(){return this.$.ironAjax.queryString},get requestUrl(){return this.$.ironAjax.requestedUrl},get requestHeaders(){return this.$.ironAjax.requestHeaders},ready:function(){this.ajaxBuilder=new TPAAjaxBuilder},toRequestOptions:function(){return this.$.ironAjax.toRequestOptions()},generateRequest:function(){return this.ajaxBuilder&&(this.headers=this.ajaxBuilder.getHeaders(this.headers),this.body=this.ajaxBuilder.getBody(this.headers,this.body,this.contentType)),this.$.ironAjax.generateRequest()},_handleResponse:function(e,t){t===this.lastRequest&&(this._setLastResponse(t.response),this._setLastError(null),this._setLoading(!1)),this.fire("response",t,{bubbles:this.bubbles})},_handleRequest:function(e,t){this._setLastRequest(t.request),this._setLoading(!0),this.fire("request",t,{bubbles:this.bubbles})},_handleError:function(e,t){request===this.lastRequest&&(this._setLastError({request:request,error:error}),this._setLastResponse(null),this._setLoading(!1)),this.fire("error",t,{bubbles:this.bubbles})}});</script></dom-module></body></html>