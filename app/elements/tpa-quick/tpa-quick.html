<link rel="import" href="../../bower_components/tpa-styles/tpa-styles.html">
<link rel="import" href="../../bower_components/tpa-money-transfer/tpa-money-transfer.html">

<link rel="import" href="../../bower_components/iron-signals/iron-signals.html">

<link rel="import" href="../../bower_components/paper-fab/paper-fab.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/paper-fab-menu/paper-fab-menu.html">
<link rel="import" href="../../bower_components/paper-fab-menu/paper-fab-menu-item.html">
<link rel="import" href="../../bower_components/tpa-toast-action/tpa-toast-action.html">

<link rel="import" href="../../bower_components/tpa-reactive/tpa-reactive-user.html">

<link rel="import" href="../tpa-container/tpa-container.html">

<dom-module id="tpa-quick">
    <style>

        :host {
            position: fixed;
            bottom: 0;
            width: 100%;
        }

        paper-fab {
            position: absolute;
            bottom: 20px;
            right: 20px;
        }

        tpa-toast-action {
            position: absolute;
            bottom: 0px;
            right: 100px;
            height: 500px;
            width: 400px;
        }

        paper-dialog h2 {
            background-color: #0a3142;
            margin: 0;
        }

    </style>

    <template>

        <tpa-reactive-user id="reactiveUser"></tpa-reactive-user>

        <iron-signals on-iron-signal-quick="_handleEvent"></iron-signals>

        <div class="quick">

            <tpa-toast-action id="toastAction" header="Quick money transfer">
                <tpa-money-transfer id="moneyTransfer"></tpa-money-transfer>

                <div class="buttons">
                    <paper-button dialog-confirm>Submit</paper-button>
                </div>

            </tpa-toast-action>

            <paper-fab icon="add" title="plus" on-tap="open"></paper-fab>


        </div>

    </template>

    <script>
        Polymer({
            is: "tpa-quick",
            ready:function(){
                this.$.reactiveUser.subscribe(function(user){
                    this.$.moneyTransfer.accountOwner = user.name;
                    this.$.moneyTransfer.accountNumber = user.account;
                    this.$.moneyTransfer.accountBalance = 5300;
                }.bind(this))
            },
            _handleEvent: function(e, data){
                this.$.toastAction.opened = true;
                this.$.moneyTransfer.querySelectorAll('input')[0].value = data.amount;
                this.$.moneyTransfer.querySelector('vaadin-combo-box').value = data.name;
                this.$.moneyTransfer.querySelectorAll('input')[2].value = data.accountNumber;
                this.$.moneyTransfer.querySelectorAll('input')[3].value = data.description;
            },
            open: function () {
                this.$.toastAction.opened = true;
            }
        })
    </script>
</dom-module>
