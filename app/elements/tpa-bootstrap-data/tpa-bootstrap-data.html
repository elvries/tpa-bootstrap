<link rel="import" href="../../bower_components/tpa-ajax/tpa-ajax.html">
<link rel="import" href="../../bower_components/iron-meta/iron-meta.html">
<!--
`tpa-bootstrap-data` will fetch all the data required for the navigation and menu bar elements.

@element tpa-bootstrap-data
-->
<dom-module id="tpa-bootstrap-data">
  <template>
    <tpa-ajax
      id="getBootstrapData"
      url="{{services.bootstrap}}"
      handle-as="json"
      on-response="handleBootstrapResponse"></tpa-ajax>
    <iron-meta-query key="services" value="{{services}}"></iron-meta-query>
  </template>
  <script>
    Polymer({
      is: "tpa-bootstrap-data",
      properties: {
        services: {
          type: Object,
          notify:true
        }
      },
      ready: function(){
        console.log('request', this.$.getBootstrapData);
        this.$.getBootstrapData.generateRequest();
      },
      handleBootstrapResponse: function(e, data){
        console.log('calling bootstrap data request', data);
        this.fire("iron-signal", {
          name: "bootstrap-data",
          data: data.response
        });
      }
    })
  </script>
</dom-module>
